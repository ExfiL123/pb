<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Пиксель Баттл от Monser DM</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>

<body>
    <header>
        <div class="logo">
            <img src="/mlogo3.svg" alt="Monser DM Logo">
            <h1>Monser DM</h1>
        </div>
        <nav>
            <ul>
                <li><a href="https://monser.ru/">Главная</a></li>
                <li><a href="https://monser.ru/play">Начать играть</a></li>
                <li><a href="https://forum.monser.ru/">Форум</a></li>
                <li><a href="https://shop.monser.ru/">Магазин</a></li>
                <li><a href="#" id="top-players-btn">Топ игроков</a></li>
                <li><a href="#" id="updates-btn">Обновления</a></li>
                <li><a href="https://vk.com/monser_dm">VK Group</a></li>
            </ul>
        </nav>
        <div class="auth-section">
            <div id="logged-out" class="auth-container">
                <button id="login-btn" class="auth-btn">Войти</button>
                <button id="register-btn" class="auth-btn secondary">Регистрация</button>
            </div>
            <div id="logged-in" class="auth-container hidden">
                <i class="fas fa-user user-icon"></i>
                <img id="user-avatar" class="hidden" alt="Аватар пользователя" width="32" height="32">
                <span id="username-display"></span>
                <button id="shop-btn" class="shop-btn hidden">
                    <i class="fas fa-store"></i>
                    <span id="coins-display">0</span>
                </button>
                <button id="admin-panel-btn" class="hidden">Админ-панель</button>
                <button id="logout-btn">Выйти</button>
            </div>
        </div>
    </header>

    <main>
        <div class="hero">
            <h2>Пиксель Баттл от Monser DM</h2>
            <p>Создавайте пиксельные шедевры вместе с сообществом Monser DM! Размещайте пиксели, сотрудничайте с другими
                игроками и оставьте свой след в истории.</p>
            <p class="time-notice">Холст доступен с 06:00 до 23:59 ежедневно (МСК)</p>
        </div>

        <div id="canvas-container">
            <div id="canvas-controls">
                <div class="color-picker">
                    <label for="color-picker">Цвет:</label>
                    <input type="color" id="color-picker" value="#6c5dd3">
                    <button id="eraser-btn" title="Ластик"><i class="fas fa-eraser"></i></button>
                </div>
                <div class="zoom-controls">
                    <button id="zoom-in"><i class="fas fa-search-plus"></i></button>
                    <button id="zoom-out"><i class="fas fa-search-minus"></i></button>
                    <button id="reset-view"><i class="fas fa-compress-arrows-alt"></i></button>
                </div>
            </div>
            <div id="canvas-wrapper">
                <canvas id="pixel-canvas"></canvas>
            </div>
            <div id="canvas-status" class="hidden">
                <div class="status-message">Рисование доступно с 06:00 до 23:59 МСК</div>
                <div class="time-display">Текущее время: <span id="current-time"></span></div>
            </div>
        </div>
    </main>

    <!-- Модальное окно входа -->
    <div id="login-modal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>Вход</h2>
            <form id="login-form">
                <div class="form-group">
                    <label for="login-username">Имя пользователя</label>
                    <input type="text" id="login-username" name="username" required>
                </div>
                <div class="form-group">
                    <label for="login-password">Пароль</label>
                    <input type="password" id="login-password" name="password" required>
                </div>
                <p id="login-error" class="error-message"></p>
                <button type="submit">Войти</button>
                <p class="form-footer">
                    Нет аккаунта? <a href="#" id="show-register">Зарегистрироваться</a>
                </p>
            </form>
        </div>
    </div>

    <!-- Модальное окно регистрации -->
    <div id="register-modal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>Регистрация</h2>
            <form id="register-form">
                <div class="form-group">
                    <label for="register-username">Имя пользователя</label>
                    <input type="text" id="register-username" name="username" required minlength="3" maxlength="30">
                    <p id="username-status" class="input-status"></p>
                </div>
                <div class="form-group">
                    <label for="register-password">Пароль</label>
                    <input type="password" id="register-password" name="password" required minlength="6">
                    <p class="input-hint">Минимум 6 символов</p>
                </div>
                <div class="form-group">
                    <label for="register-confirm-password">Подтвердите пароль</label>
                    <input type="password" id="register-confirm-password" name="confirm_password" required>
                </div>
                <div class="form-group">
                    <label for="captcha">Капча: Решите пример</label>
                    <div class="captcha-container">
                        <span id="captcha-question"></span>
                        <input type="number" id="captcha-answer" name="captcha" required>
                    </div>
                    <p id="captcha-status" class="input-status"></p>
                </div>
                <p id="register-error" class="error-message"></p>
                <button type="submit">Зарегистрироваться</button>
                <p class="form-footer">
                    Уже есть аккаунт? <a href="#" id="show-login">Войти</a>
                </p>
            </form>
        </div>
    </div>

    <!-- Модальное окно админ-панели -->
    <div id="admin-modal" class="modal">
        <div class="modal-content admin-content">
            <span class="close">&times;</span>
            <h2>Админ-панель</h2>

            <div class="admin-tabs">
                <button class="tab-btn active" data-tab="clear-tab">Очистка холста</button>
                <button class="tab-btn" data-tab="users-tab">Управление пользователями</button>
                <button class="tab-btn" data-tab="settings-tab">Настройки</button>
                <button class="tab-btn" id="admin-management-tab-btn" data-tab="admin-management-tab">Управление
                    админами</button>
            </div>

            <div id="clear-tab" class="tab-content">
                <h3>Очистка области холста</h3>
                <form id="clear-pixels-form">
                    <div class="form-group">
                        <label>Начальные координаты:</label>
                        <div class="coord-inputs">
                            <input type="number" id="start-x" placeholder="X" required min="0">
                            <input type="number" id="start-y" placeholder="Y" required min="0">
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Конечные координаты:</label>
                        <div class="coord-inputs">
                            <input type="number" id="end-x" placeholder="X" required min="0">
                            <input type="number" id="end-y" placeholder="Y" required min="0">
                        </div>
                    </div>
                    <button type="submit" class="secondary">Очистить область</button>
                    <p id="clear-error" class="error-message"></p>
                </form>
            </div>

            <div id="users-tab" class="tab-content hidden">
                <h3>Управление пользователями</h3>
                <div class="users-list-container">
                    <table id="users-table">
                        <thead>
                            <tr>
                                <th>Аватар</th>
                                <th>Имя пользователя</th>
                                <th>Админ</th>
                                <th>Последний вход</th>
                                <th>Статус</th>
                                <th>Действия</th>
                            </tr>
                        </thead>
                        <tbody id="users-list">
                            <tr>
                                <td colspan="6">Загрузка пользователей...</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div id="users-pagination" class="pagination-container">
                    <!-- Здесь будут кнопки пагинации -->
                </div>
                <p id="users-error" class="error-message"></p>
            </div>

            <div id="settings-tab" class="tab-content hidden">
                <h3>Настройки холста</h3>
                <div class="form-group">
                    <label for="canvas-lock">Блокировка холста:</label>
                    <div class="toggle-switch">
                        <input type="checkbox" id="canvas-lock" class="toggle-input">
                        <label for="canvas-lock" class="toggle-label"></label>
                    </div>
                    <p class="setting-description">Когда включено, никто кроме администраторов не может размещать
                        пиксели</p>
                </div>
                <button id="save-settings" class="secondary">Сохранить настройки</button>
                <p id="settings-error" class="error-message"></p>
                <p id="settings-success" class="success-message"></p>
            </div>

            <div id="admin-management-tab" class="tab-content hidden">
                <h3>Управление администраторами</h3>
                <div class="form-group">
                    <label for="admin-search">Поиск пользователя:</label>
                    <div class="search-container">
                        <input type="text" id="admin-search" placeholder="Введите имя пользователя">
                        <button id="admin-search-btn" class="secondary">Поиск</button>
                    </div>
                </div>
                <div id="admin-search-results" class="search-results">
                    <!-- Здесь будут результаты поиска -->
                </div>
                <p id="admin-management-error" class="error-message"></p>
                <p id="admin-management-success" class="success-message"></p>
            </div>
        </div>
    </div>

<!-- Модальное окно магазина -->
<div id="shop-modal" class="modal">
    <div class="modal-content">
        <span class="close">&times;</span>
        <h2>Магазин</h2>
        <div class="shop-items">
            <div class="shop-item">
                <div class="shop-item-image">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" width="80" height="80">
                        <!-- Фитиль -->
                        <path d="M60,20 Q65,10 70,5" stroke="#FFA500" stroke-width="3" fill="none"
                            stroke-linecap="round" />
                        <circle cx="70" cy="5" r="3" fill="#FF4500" />

                        <!-- Основная часть бомбы -->
                        <circle cx="50" cy="60" r="35" fill="#222" stroke="#444" stroke-width="2" />

                        <!-- Блик -->
                        <circle cx="40" cy="45" r="8" fill="#444" />

                        <!-- Крышка -->
                        <rect x="45" y="20" width="10" height="10" fill="#555" rx="2" />
                    </svg>
                </div>
                <div class="shop-item-info">
                    <h3>Бомбочка</h3>
                    <p>Стирает 10 ближайших пикселей</p>
                    <div class="shop-item-price">10 коинов</div>
                </div>
                <button id="buy-bomb-btn" class="buy-btn">Купить</button>
            </div>

            <!-- Добавляем премиум-статус -->
            <div class="shop-item premium-item">
                <div class="shop-item-image">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" width="80" height="80">
                        <polygon points="50,10 61,35 90,38 70,58 74,85 50,73 26,85 30,58 10,38 39,35" fill="#FFD700"
                            stroke="#FFA500" stroke-width="2" />
                        <text x="50" y="55" font-family="Arial" font-size="30" font-weight="bold" text-anchor="middle"
                            fill="#FFF">P</text>
                        <circle cx="50" cy="50" r="45" fill="none" stroke="#FFD700" stroke-width="2"
                            stroke-dasharray="5,5" />
                    </svg>
                </div>
                <div class="shop-item-info">
                    <h3>Премиум</h3>
                    <p>Премиум-статус на 30 дней: цветной ник, отсутствие задержки при размещении пикселей</p>
                    <div class="shop-item-price">1000 коинов</div>
                </div>
                <button id="buy-premium-btn" class="buy-btn premium-buy-btn">Купить</button>
            </div>
        </div>
        <p id="shop-error" class="error-message"></p>
    </div>
</div>


    <!-- Модальное окно профиля пользователя -->
    <div id="profile-modal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>Профиль пользователя</h2>
            <div class="profile-stats">
                <div class="stat-item">
                    <i class="fas fa-clock"></i>
                    <div class="stat-info">
                        <h3>Время на сайте</h3>
                        <p id="total-time">0 минут</p>
                    </div>
                </div>
                <div class="stat-item">
                    <i class="fas fa-paint-brush"></i>
                    <div class="stat-info">
                        <h3>Размещено пикселей</h3>
                        <p id="total-pixels">0</p>
                    </div>
                </div>
                <div class="stat-item">
                    <i class="fas fa-coins"></i>
                    <div class="stat-info">
                        <h3>Коины</h3>
                        <p id="total-coins">0</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Модальное окно топа игроков -->
    <div id="top-players-modal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>Топ игроков</h2>
            <div class="top-players-controls">
                <button id="sort-by-pixels" class="sort-btn active">По пикселям</button>
                <button id="sort-by-time" class="sort-btn">По времени</button>
            </div>
            <div class="top-players-table-container">
                <table id="top-players-table">
                    <thead>
                        <tr>
                            <th>Ник</th>
                            <th>Время проведенное в игре</th>
                            <th>Количество установленных пикселей</th>
                        </tr>
                    </thead>
                    <tbody id="top-players-list">
                        <tr>
                            <td colspan="3">Загрузка данных...</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

<!-- Модальное окно лога обновлений -->
<div id="updates-modal" class="modal">
    <div class="modal-content">
        <span class="close">&times;</span>
        <h2>Лог обновлений</h2>
        <div class="updates-list">
            <div class="update-item">
                <div class="update-date">14.05.2025</div>
                <div class="update-content">
                    <h3>Обновление 1.1</h3>
                    <ul>
                        <li>Добавлен премиум-статус за 1000 коинов:
                            <ul>
                                <li>Выделение в топе игроков с подсветкой PREMIUM</li>
                                <li>Оранжевый ник с подсветкой</li>
                                <li>Уменьшенная задержка при размещении пикселей (0.5 сек вместо 2 сек)</li>
                            </ul>
                        </li>
                        <li>Изменены привилегии игроков:
                            <ul>
                                <li>Администратор - зеленый ник с меткой "Admin"</li>
                                <li>Главный администратор - красный ник с меткой "Super admin"</li>
                            </ul>
                        </li>
                        <li>Обновлен топ игроков - теперь учитывается каждая минута и секунда в игре</li>
                    </ul>
                </div>
            </div>
            <div class="update-item">
                <div class="update-date">13.05.2025</div>
                <div class="update-content">
                    <h3>Обновление 1.0</h3>
                    <ul>
                        <li>Добавлена капча при регистрации</li>
                        <li>Добавлен магазин за коины</li>
                        <li>Система начисления коинов:
                            <ul>
                                <li>5 минут на сайте: +2 коина</li>
                                <li>10 минут: +3 коина</li>
                                <li>15 минут: +3 коина</li>
                                <li>30 минут: +5 коинов</li>
                                <li>За размещение пикселей:
                                    <ul>
                                        <li>15 пикселей: +1 коин</li>
                                        <li>30 пикселей: +1 коин</li>
                                        <li>50 пикселей: +2 коина</li>
                                        <li>75 пикселей: +3 коина</li>
                                        <li>100 пикселей: +5 коинов</li>
                                        <li>После 100 пикселей: +5 коинов за каждые 50 пикселей</li>
                                    </ul>
                                </li>
                            </ul>
                        </li>
                        <li>Добавлена бомбочка за 10 коинов, которая стирает 10 ближайших пикселей</li>
                        <li>Добавлена статистика пользователя</li>
                        <li>Добавлен топ игроков с сортировкой по времени и количеству пикселей</li>
                        <li>Добавлена система главного администратора для управления админами</li>
                        <li>Исправлена проблема с регистрацией более 3-х аккаунтов с одного IP</li>
                        <li>Исправлена проблема со сбросом коинов после перезагрузки страницы</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>

    <footer>
        <div class="footer-content">
            <div class="footer-logo">
                <img src="/mlogo3.svg" alt="Monser DM Logo">
            </div>
            <div class="footer-links">
                <a href="https://monser.ru/about">О проекте</a>
                <a href="https://monser.ru/rules">Правила</a>
                <a href="https://monser.ru/support">Поддержка</a>
            </div>
            <div class="social-links">
                <a href="https://vk.com/monser_dm" target="_blank"><i class="fab fa-vk"></i></a>
                <a href="https://discord.gg/monser" target="_blank"><i class="fab fa-discord"></i></a>
                <a href="https://t.me/monser_dm" target="_blank"><i class="fab fa-telegram"></i></a>
                <a href="https://www.youtube.com/channel/monser" target="_blank"><i class="fab fa-youtube"></i></a>
            </div>
            <div class="copyright">
                &copy; Monser DM 2025. Все права защищены.
            </div>
        </div>
    </footer>

    <script>
        document.addEventListener('contextmenu', event => event.preventDefault());

        document.addEventListener('keydown', function (event) {
            if (
                event.key === 'F12' ||
                (event.ctrlKey && event.shiftKey && event.key === 'I') ||
                (event.ctrlKey && event.key === 'U') ||
                (event.ctrlKey && event.shiftKey && event.key === 'J') ||
                (event.ctrlKey && event.shiftKey && event.key === 'C')
            ) {
                event.preventDefault();
            }
        });
    </script>

    <script src="app.js"></script>
</body>

</html>